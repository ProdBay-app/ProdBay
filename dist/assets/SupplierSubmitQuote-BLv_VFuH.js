import{f as g,r as o,j as e,F as h}from"./index-Bj-tmwIw.js";import{s as i}from"./supabase-D_wOUl-A.js";import{S as y}from"./send-CRyXVvUJ.js";const _=()=>{const{showSuccess:m,showError:c}=g(),[p,x]=o.useState([]),[a,r]=o.useState({asset_id:"",cost:0,notes_capacity:""}),[n,d]=o.useState(!1);o.useEffect(()=>{f()},[]);const f=async()=>{try{const{data:s}=await i.from("assets").select("*").order("created_at",{ascending:!1});x(s||[])}catch(s){console.error("Failed to load assets",s)}},b=async s=>{if(s.preventDefault(),!(!a.asset_id||a.cost<=0)){d(!0);try{let t=null;const{data:l}=await i.from("suppliers").select("id").limit(1);if(t=l&&l.length>0?l[0].id:null,!t){c("No supplier found. Please ask admin to create a supplier entry.");return}const{error:u}=await i.from("quotes").insert({supplier_id:t,asset_id:a.asset_id,cost:a.cost,notes_capacity:a.notes_capacity,status:"Submitted"});if(u)throw u;m("Quote submitted successfully"),r({asset_id:"",cost:0,notes_capacity:""})}catch(t){console.error("Failed to submit quote",t),c("Failed to submit quote")}finally{d(!1)}}};return e.jsx("div",{className:"max-w-3xl mx-auto",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-8",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx(h,{className:"h-6 w-6 text-orange-600"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Submit Quote"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Asset *"}),e.jsxs("select",{value:a.asset_id,onChange:s=>r(t=>({...t,asset_id:s.target.value})),required:!0,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Select an asset"}),p.map(s=>e.jsx("option",{value:s.id,children:s.asset_name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Cost *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"$"}),e.jsx("input",{type:"number",value:a.cost||"",onChange:s=>r(t=>({...t,cost:parseFloat(s.target.value)||0})),min:0,step:.01,required:!0,className:"w-full pl-8 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"0.00"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes & Capacity"}),e.jsx("textarea",{value:a.notes_capacity,onChange:s=>r(t=>({...t,notes_capacity:s.target.value})),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",placeholder:"Include details about your capacity, timeline, terms, etc."})]}),e.jsx("div",{className:"flex justify-end pt-4 border-t",children:e.jsxs("button",{type:"submit",disabled:n||!a.asset_id||a.cost<=0,className:"flex items-center space-x-2 px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:opacity-50",children:[e.jsx(y,{className:"h-4 w-4"}),e.jsx("span",{children:n?"Submitting...":"Submit Quote"})]})})]})]})})};export{_ as default};
