import{d as D,f as G,r as o,j as e,X as Ee,D as Y,a as $e,c as qe,P as Fe,C as ts,E as as}from"./index-Bj-tmwIw.js";import{s as y}from"./supabase-D_wOUl-A.js";import{R as pe,B as se,S as he}from"./railwayApiService-OM36Qiyn.js";import{M as Ie,U as Ae,S as Se,P as rs,C as ls,a as Qe}from"./user-GNX0SQJ0.js";import{S as is}from"./send-CRyXVvUJ.js";import{T as ue}from"./trending-up-C8H7i0eB.js";import{C as ns}from"./calendar-BVjs4xWM.js";import{C as cs}from"./circle-x-nv1y8tp-.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const os=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],ds=D("chevron-left",os);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ms=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],xs=D("chevron-right",ms);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ps=D("chevron-up",us);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hs=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ce=D("loader-circle",hs);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gs=[["path",{d:"M5 12h14",key:"1ays0h"}]],fs=D("minus",gs);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],ys=D("pencil",js);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],ws=D("target",bs);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],vs=D("trash",Ns);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Pe=D("trending-down",_s);class As{static async findRelevantSuppliers(s,t=[]){const{data:a,error:r}=await y.from("suppliers").select("*");if(r||!a)return[];const c=a.filter(u=>u.service_categories.some(d=>d.toLowerCase().includes(s.toLowerCase())||s.toLowerCase().includes(d.toLowerCase())));if(!t||t.length===0)return c;const i=t.map(u=>u.toLowerCase());return c.filter(u=>u.service_categories.some(d=>i.includes(d.toLowerCase())))}static async sendQuoteRequestsForAsset(s,t=[],a=null){const r=await this.findRelevantSuppliers(s.asset_name,t);for(const c of r){const{data:i,error:u}=await y.from("quotes").insert({supplier_id:c.id,asset_id:s.id,status:"Submitted"}).select().single();if(i&&!u){const d=`Quote Request: ${s.asset_name}`;`${s.asset_name}${s.specifications||""}${window.location.origin}${i.quote_token}`,console.log(`Email (simulated) to ${c.contact_email}: ${d}`)}}await y.from("assets").update({status:"Quoting"}).eq("id",s.id)}static async acceptQuote(s){const{data:t}=await y.from("quotes").select("*, asset:assets(*)").eq("id",s).single();t&&(await y.from("quotes").update({status:"Accepted"}).eq("id",s),await y.from("quotes").update({status:"Rejected"}).eq("asset_id",t.asset_id).neq("id",s),await y.from("assets").update({assigned_supplier_id:t.supplier_id,status:"Approved"}).eq("id",t.asset_id))}static async updateProjectStatus(s){const{data:t}=await y.from("assets").select("status").eq("project_id",s);if(!t||t.length===0)return;let a="New";const r=t.map(c=>c.status);r.every(c=>c==="Delivered")?a="Completed":r.some(c=>c==="In Production"||c==="Approved")?a="In Progress":r.some(c=>c==="Quoting")&&(a="Quoting"),await y.from("projects").update({project_status:a}).eq("id",s)}}class Ss{static getBaseUrl(){return"http://localhost:3000".replace(/\/$/,"")}static async getSuggestedSuppliers(s){var t,a;try{const r=await fetch(`${this.getBaseUrl()}/api/suppliers/suggestions/${s}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok){const i=await r.json().catch(()=>({}));throw new Error(((t=i.error)==null?void 0:t.message)||`HTTP ${r.status}: ${r.statusText}`)}const c=await r.json();if(!c.success)throw new Error(((a=c.error)==null?void 0:a.message)||"Failed to fetch supplier suggestions");return c.data}catch(r){throw console.error("Error fetching supplier suggestions:",r),r}}static async sendQuoteRequests(s,t,a){var r,c;try{const i=await fetch(`${this.getBaseUrl()}/api/suppliers/send-quote-requests`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({assetId:s,supplierIds:t,from:a})});if(!i.ok){const d=await i.json().catch(()=>({}));throw new Error(((r=d.error)==null?void 0:r.message)||`HTTP ${i.status}: ${i.statusText}`)}const u=await i.json();if(!u.success)throw new Error(((c=u.error)==null?void 0:c.message)||"Failed to send quote requests");return u.data}catch(i){throw console.error("Error sending quote requests:",i),i}}static async healthCheck(){try{return(await fetch(`${this.getBaseUrl()}/api/suppliers/health`,{method:"GET"})).ok}catch(s){return console.error("Supplier API health check failed:",s),!1}}}class ke{static async analyzeBriefForAssets(s,t={}){throw new Error("Railway API URL not configured. Please set VITE_RAILWAY_API_URL environment variable.")}static async createAssetsFromAI(s,t){throw new Error("Railway API URL not configured. Please set VITE_RAILWAY_API_URL environment variable.")}static async checkAIHealth(){return{success:!1,message:"Railway API URL not configured"}}}class Cs{static async generateEmailPreviews(s,t,a){var c;const r=await pe.post("/api/suppliers/preview-quote-requests",{assetId:s,supplierIds:t,from:a});if(!r.success)throw new Error(((c=r.error)==null?void 0:c.message)||"Failed to generate email previews");return r}static async sendQuoteRequests(s,t,a,r){var i;const c=await pe.post("/api/suppliers/send-quote-requests",{assetId:s,supplierIds:t,from:r,customizedEmails:a});if(!c.success)throw new Error(((i=c.error)==null?void 0:i.message)||"Failed to send quote requests");return c}}class M{static async loadProjects(){const{data:s,error:t}=await y.from("projects").select("*").order("created_at",{ascending:!1});if(t)throw t;return s||[]}static async loadProject(s){const{data:t,error:a}=await y.from("projects").select("*").eq("id",s).single();if(a)throw a;return t}static async createProject(s){const{data:t,error:a}=await y.from("projects").insert({project_name:s.project_name,client_name:s.client_name,brief_description:s.brief_description,physical_parameters:s.physical_parameters,financial_parameters:s.financial_parameters??0,timeline_deadline:s.timeline_deadline||null,project_status:"New"}).select().single();if(a||!t)throw a||new Error("Failed to create project");return t}static async updateProject(s,t){const{error:a}=await y.from("projects").update({project_name:t.project_name,client_name:t.client_name,brief_description:t.brief_description,physical_parameters:t.physical_parameters,financial_parameters:t.financial_parameters??null,timeline_deadline:t.timeline_deadline||null}).eq("id",s);if(a)throw a}static async deleteProject(s){const{data:t,error:a}=await y.from("assets").select("id").eq("project_id",s);if(a)throw a;const r=(t||[]).map(i=>i.id);r.length>0&&(await y.from("quotes").delete().in("asset_id",r),await y.from("assets").delete().in("id",r));const{error:c}=await y.from("projects").delete().eq("id",s);if(c)throw c}static async loadProjectAssets(s){const{data:t,error:a}=await y.from("assets").select(`
        *,
        assigned_supplier:suppliers(*)
      `).eq("project_id",s);if(a)throw a;return t||[]}static async createAsset(s,t){const{error:a}=await y.from("assets").insert({project_id:s,asset_name:t.asset_name,specifications:t.specifications||null,timeline:t.timeline||null,status:t.status,assigned_supplier_id:t.assigned_supplier_id||null});if(a)throw a}static async updateAsset(s,t){const{error:a}=await y.from("assets").update({asset_name:t.asset_name,specifications:t.specifications||null,timeline:t.timeline||null,status:t.status,assigned_supplier_id:t.assigned_supplier_id||null}).eq("id",s);if(a)throw a}static async deleteAsset(s){await y.from("quotes").delete().eq("asset_id",s);const{error:t}=await y.from("assets").delete().eq("id",s);if(t)throw t}static async loadQuotesForAssets(s){if(s.length===0)return[];const{data:t,error:a}=await y.from("quotes").select(`
        *,
        supplier:suppliers(*),
        asset:assets(*)
      `).in("asset_id",s);if(a)throw a;return t||[]}static async rejectQuote(s){const{error:t}=await y.from("quotes").update({status:"Rejected"}).eq("id",s);if(t)throw t}static async loadSuppliers(){const{data:s,error:t}=await y.from("suppliers").select("*").order("supplier_name");if(t)throw t;return s||[]}static async loadProducerSettings(){const{data:s,error:t}=await y.from("producer_settings").select("*").limit(1).single();return t?null:s?{from_name:String(s.from_name),from_email:String(s.from_email)}:null}static async loadProjectDetails(s){const t=await this.loadProjectAssets(s);let a=[];if(t.length>0){const r=t.map(c=>c.id);a=await this.loadQuotesForAssets(r)}return{assets:t,quotes:a}}static getAvailableTags(s){return Array.from(new Set(s.flatMap(t=>(t.service_categories||[]).map(a=>(a||"").trim())).filter(Boolean))).sort()}}const Ps=()=>{const{showSuccess:n,showError:s,showWarning:t,showConfirm:a}=G(),[r,c]=o.useState([]),[i,u]=o.useState(null),[d,p]=o.useState(!0),[w,b]=o.useState(!1),[j,E]=o.useState(!1),[k,$]=o.useState(!1),[C,q]=o.useState({project_name:"",client_name:"",brief_description:"",physical_parameters:"",financial_parameters:0,timeline_deadline:""}),[S,F]=o.useState("static");o.useEffect(()=>{N()},[]);const N=o.useCallback(async()=>{try{const x=await M.loadProjects();c(x),x.length>0&&!i&&u(x[0])}catch(x){console.error("Error loading projects:",x),s("Failed to load projects")}finally{p(!1)}},[i,s]),P=o.useCallback(x=>{u(x)},[]),A=o.useCallback(()=>{E(!1),q({project_name:"",client_name:"",brief_description:"",physical_parameters:"",financial_parameters:void 0,timeline_deadline:""}),F("static"),b(!0)},[]),T=o.useCallback(()=>{i&&(E(!0),q({project_name:i.project_name||"",client_name:i.client_name||"",brief_description:i.brief_description||"",physical_parameters:i.physical_parameters||"",financial_parameters:i.financial_parameters,timeline_deadline:i.timeline_deadline||""}),F("static"),b(!0))},[i]),I=o.useCallback(()=>{b(!1),E(!1),$(!1)},[]),L=o.useCallback((x,v)=>{q(z=>({...z,[x]:x==="financial_parameters"?v===""?void 0:Number(v):v}))},[]),l=o.useCallback(x=>{F(x)},[]),m=o.useCallback(async x=>{var v,z,W,U;x.preventDefault(),$(!0);try{if(j&&i)await M.updateProject(i.id,C),await N(),n("Project updated successfully");else{const R=await M.createProject(C);if(C.brief_description)try{const Q=await pe.processBrief(R.id,C.brief_description,{allocationMethod:S,projectContext:{financial_parameters:C.financial_parameters,timeline_deadline:C.timeline_deadline,physical_parameters:C.physical_parameters}});if(!Q.success)console.warn("Brief processing failed:",(v=Q.error)==null?void 0:v.message),t(`Project created successfully, but brief processing failed: ${(z=Q.error)==null?void 0:z.message}. You can manually create assets later.`);else{console.log("Brief processed successfully:",(W=Q.data)==null?void 0:W.createdAssets.length,"assets created");const V=S==="ai"?"AI-powered":"static";n(`Project created successfully! ${(U=Q.data)==null?void 0:U.createdAssets.length} assets were automatically generated using ${V} allocation.`,{duration:6e3})}}catch(Q){console.error("Brief processing error:",Q),t("Project created successfully, but brief processing failed. You can manually create assets later.")}else n("Project created successfully");await N();const B=await M.loadProject(R.id);u(B||R)}I()}catch(R){console.error("Failed to submit project form",R),s("Failed to save project")}finally{$(!1)}},[j,i,C,S,N,n,t,s,I]),_=o.useCallback(async()=>{if(!(!i||!await a({title:"Delete Project",message:"Delete this project and all related assets/quotes? This cannot be undone.",variant:"danger",confirmText:"Delete",cancelText:"Cancel"})))try{await M.deleteProject(i.id),await N(),u(null),n("Project deleted successfully")}catch(v){console.error("Failed to delete project",v),s("Failed to delete project")}},[i,N,a,n,s]),g=o.useCallback(async()=>{await N()},[N]);return{projects:r,currentProject:i,isLoading:d,showProjectModal:w,isEditingProject:j,isSubmittingProject:k,projectForm:C,allocationMethod:S,loadProjects:N,selectProject:P,openCreateProject:A,openEditProject:T,closeProjectModal:I,updateProjectForm:L,setAllocationMethod:l,submitProjectForm:m,deleteProject:_,refreshProjects:g}},ks=n=>{const{showSuccess:s,showError:t,showConfirm:a}=G(),[r,c]=o.useState([]),[i,u]=o.useState([]),[d,p]=o.useState([]),[w,b]=o.useState(!1),[j,E]=o.useState(!1),[k,$]=o.useState(!1),[C,q]=o.useState(!1),[S,F]=o.useState({id:void 0,asset_name:"",specifications:"",timeline:"",status:"Pending",assigned_supplier_id:void 0}),N=o.useCallback(async()=>{try{const g=await M.loadSuppliers();p(g)}catch(g){console.error("Failed to load suppliers",g)}},[]),P=o.useCallback(async g=>{b(!0);try{const{assets:x,quotes:v}=await M.loadProjectDetails(g);c(x),u(v)}catch(x){console.error("Error loading project details:",x),t("Failed to load project details")}finally{b(!1)}},[t]),A=o.useCallback(async()=>{n&&(await N(),$(!1),F({id:void 0,asset_name:"",specifications:"",timeline:"",status:"Pending",assigned_supplier_id:void 0}),E(!0))},[n,N]),T=o.useCallback(async g=>{await N(),$(!0),F({id:g.id,asset_name:g.asset_name,specifications:g.specifications||"",timeline:g.timeline||"",status:g.status,assigned_supplier_id:g.assigned_supplier_id}),E(!0)},[N]),I=o.useCallback(()=>{E(!1),$(!1),q(!1)},[]),L=o.useCallback((g,x)=>{F(v=>({...v,[g]:x}))},[]),l=o.useCallback(async g=>{if(g.preventDefault(),!!n){q(!0);try{k&&S.id?(await M.updateAsset(S.id,S),s("Asset updated successfully")):(await M.createAsset(n.id,S),s("Asset created successfully")),await P(n.id),I()}catch(x){console.error("Failed to save asset",x),t("Failed to save asset")}finally{q(!1)}}},[k,S,n,P,s,t,I]),m=o.useCallback(async g=>{if(await a({title:"Delete Asset",message:"Delete this asset and any related quotes?",variant:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{await M.deleteAsset(g.id),n&&await P(n.id),s("Asset deleted successfully")}catch(v){console.error("Failed to delete asset",v),t("Failed to delete asset")}},[n,P,a,s,t]),_=o.useCallback(async g=>{await P(g)},[P]);return o.useEffect(()=>{n?P(n.id):(c([]),u([]))},[n,P]),{assets:r,quotes:i,suppliers:d,isLoading:w,showAssetModal:j,isEditingAsset:k,isSubmittingAsset:C,assetForm:S,loadProjectDetails:P,openCreateAsset:A,openEditAsset:T,closeAssetModal:I,updateAssetForm:L,submitAssetForm:l,deleteAsset:m,refreshAssets:_}},Es=({isOpen:n,onClose:s,asset:t,supplierIds:a,onSend:r})=>{var I,L;const{showError:c}=G(),[i,u]=o.useState([]),[d,p]=o.useState(0),[w,b]=o.useState([]),[j,E]=o.useState(!1),[k,$]=o.useState(!1);o.useEffect(()=>{n&&a.length>0&&C()},[n,a,t]);const C=async()=>{E(!0);try{const{data:l,error:m}=await y.from("suppliers").select("*").in("id",a);if(m)throw m;const _=l.map(x=>{var B,Q;const v=((B=x.contact_persons)==null?void 0:B.find(V=>V.is_primary))||((Q=x.contact_persons)==null?void 0:Q[0]),z=(v==null?void 0:v.name)||x.supplier_name,W=(v==null?void 0:v.email)||x.contact_email,U=`Quote Request: ${t.asset_name}`,R=`Dear ${z},

We would like to request a quote for the following asset:

Asset: ${t.asset_name}
Specifications: ${t.specifications||"See project brief for details"}
Timeline: ${t.timeline||"To be discussed"}

Please provide your quote by visiting the link below and submitting your proposal.

Thank you for your time and we look forward to working with you.

Best regards,
[Your Name]
[Your Company]`;return{id:x.id,supplier_name:x.supplier_name,contact_email:x.contact_email,contact_persons:x.contact_persons||[],preview_email:{to:W,subject:U,body:R}}});u(_);const g=_.map(x=>({supplierId:x.id,subject:x.preview_email.subject,body:x.preview_email.body}));b(g)}catch(l){console.error("Error generating email previews:",l),c("Failed to generate email previews")}finally{E(!1)}},q=(l,m,_)=>{b(g=>g.map(x=>x.supplierId===l?{...x,[m]:_}:x))},S=()=>{if(i.length===0)return null;const l=i[d];return w.find(m=>m.supplierId===l.id)},F=async()=>{$(!0);try{await r(w),s()}catch(l){console.error("Error sending emails:",l),c("Failed to send quote requests")}finally{$(!1)}},N=()=>{p(l=>l<i.length-1?l+1:0)},P=()=>{p(l=>l>0?l-1:i.length-1)};if(!n)return null;const A=i[d],T=S();return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Preview Quote Request Emails"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Asset: ",t.asset_name," • ",i.length," supplier(s) selected"]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ee,{className:"h-6 w-6"})})]}),j?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ce,{className:"h-6 w-6 animate-spin text-teal-600"}),e.jsx("span",{className:"text-gray-600",children:"Generating email previews..."})]})}):e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:P,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white rounded-lg transition-colors",disabled:i.length<=1,children:e.jsx(ds,{className:"h-5 w-5"})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:A==null?void 0:A.supplier_name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[d+1," of ",i.length]})]}),e.jsx("button",{onClick:N,className:"p-2 text-gray-500 hover:text-gray-700 hover:bg-white rounded-lg transition-colors",disabled:i.length<=1,children:e.jsx(xs,{className:"h-5 w-5"})})]}),A&&e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ie,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-gray-600",children:["To: ",A.preview_email.to]})]}),A.contact_persons.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-gray-600",children:((I=A.contact_persons.find(l=>l.is_primary))==null?void 0:I.name)||((L=A.contact_persons[0])==null?void 0:L.name)}),A.contact_persons.find(l=>l.is_primary)&&e.jsx(Se,{className:"h-3 w-3 text-yellow-500"})]})]})]}),e.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:T&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),e.jsx("input",{type:"text",value:T.subject,onChange:l=>q(A.id,"subject",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Body"}),e.jsx("textarea",{value:T.body,onChange:l=>q(A.id,"body",l.target.value),rows:12,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent resize-none"})]}),A.contact_persons.length>0&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Contact Person Details"}),e.jsx("div",{className:"space-y-2",children:A.contact_persons.map((l,m)=>e.jsxs("div",{className:"flex items-center space-x-4 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ae,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-700",children:l.name}),l.is_primary&&e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs",children:[e.jsx(Se,{className:"h-2 w-2"}),e.jsx("span",{children:"Primary"})]})]}),l.role&&e.jsxs("span",{className:"text-gray-500",children:["(",l.role,")"]}),l.phone&&e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[e.jsx(rs,{className:"h-3 w-3"}),e.jsx("span",{children:l.phone})]})]},m))})]})]})}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:[i.length," email(s) will be sent"]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:s,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",disabled:k,children:"Cancel"}),e.jsx("button",{onClick:F,disabled:k||i.length===0,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:k?e.jsxs(e.Fragment,{children:[e.jsx(Ce,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Sending..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(is,{className:"h-4 w-4"}),e.jsx("span",{children:"Send Quote Requests"})]})})]})]})]})]})})};class H{static async getQuoteComparison(s){throw new Error("Railway API URL not configured. Please set VITE_RAILWAY_API_URL environment variable.")}static async getQuoteSummary(s){throw new Error("Railway API URL not configured. Please set VITE_RAILWAY_API_URL environment variable.")}static formatCostBreakdown(s){const t=[];return s.labor>0&&t.push(`Labor: $${s.labor.toFixed(2)}`),s.materials>0&&t.push(`Materials: $${s.materials.toFixed(2)}`),s.equipment>0&&t.push(`Equipment: $${s.equipment.toFixed(2)}`),s.other>0&&t.push(`Other: $${s.other.toFixed(2)}`),t.join(" • ")}static formatResponseTime(s){if(s<24)return`${s}h`;{const t=Math.floor(s/24),a=s%24;return a>0?`${t}d ${a}h`:`${t}d`}}static formatValidityPeriod(s){const t=new Date(s),a=new Date,r=t.getTime()-a.getTime(),c=Math.ceil(r/(1e3*60*60*24));return c<0?"Expired":c===0?"Expires today":c===1?"Expires tomorrow":`${c} days left`}static getStatusColor(s){switch(s){case"Accepted":return"bg-green-100 text-green-800";case"Rejected":return"bg-red-100 text-red-800";case"Submitted":return"bg-blue-100 text-blue-800";default:return"bg-gray-100 text-gray-800"}}}const $s=({isOpen:n,onClose:s,assetId:t,onQuoteUpdate:a})=>{const{showSuccess:r,showError:c}=G(),[i,u]=o.useState(!1),[d,p]=o.useState(null),[w,b]=o.useState([]),[j,E]=o.useState(null),[k,$]=o.useState(new Set),[C,q]=o.useState("cost"),[S,F]=o.useState("asc");o.useEffect(()=>{n&&t&&N()},[n,t]);const N=async()=>{var l;u(!0);try{const m=await H.getQuoteComparison(t);m.success&&m.data?(p(m.data.asset),b(m.data.quotes),E(m.data.comparison_metrics)):c(`Failed to load quote comparison: ${((l=m.error)==null?void 0:l.message)||"Unknown error"}`)}catch(m){console.error("Error loading quote comparison:",m),c("Failed to load quote comparison data")}finally{u(!1)}},P=async l=>{try{const{error:m}=await y.from("quotes").update({status:"Accepted"}).eq("id",l);if(m)throw m;const{error:_}=await y.from("quotes").update({status:"Rejected"}).eq("asset_id",t).neq("id",l);if(_)throw _;r("Quote accepted successfully"),N(),a()}catch(m){console.error("Error accepting quote:",m),c("Failed to accept quote")}},A=async l=>{try{const{error:m}=await y.from("quotes").update({status:"Rejected"}).eq("id",l);if(m)throw m;r("Quote rejected"),N(),a()}catch(m){console.error("Error rejecting quote:",m),c("Failed to reject quote")}},T=l=>{const m=new Set(k);m.has(l)?m.delete(l):m.add(l),$(m)},I=[...w].sort((l,m)=>{let _,g;switch(C){case"cost":_=l.cost,g=m.cost;break;case"response_time":_=l.response_time_hours,g=m.response_time_hours;break;case"validity":_=new Date(l.valid_until).getTime(),g=new Date(m.valid_until).getTime();break;default:_=l.cost,g=m.cost}return S==="asc"?_<g?-1:_>g?1:0:_>g?-1:_<g?1:0}),L=l=>j?l.cost===j.lowest_cost?e.jsx(Pe,{className:"h-4 w-4 text-green-600",title:"Lowest cost"}):l.cost===j.highest_cost?e.jsx(ue,{className:"h-4 w-4 text-red-600",title:"Highest cost"}):e.jsx(fs,{className:"h-4 w-4 text-gray-400",title:"Average cost"}):null;return n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-7xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Quote Comparison"}),d&&e.jsxs("p",{className:"text-gray-600 mt-1",children:[d.name," • ",d.project.project_name]})]}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Ee,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-120px)]",children:i?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading quote comparison..."})]}):d&&w.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:"Asset Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Specifications:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:d.specifications})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Timeline:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:d.timeline})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Client:"}),e.jsx("p",{className:"text-gray-600 mt-1",children:d.project.client_name})]})]})]}),j&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-green-800",children:"Lowest Cost"})]}),e.jsxs("p",{className:"text-2xl font-bold text-green-900 mt-1",children:["$",j.lowest_cost.toFixed(2)]})]}),e.jsxs("div",{className:"bg-red-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-red-600"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-red-800",children:"Highest Cost"})]}),e.jsxs("p",{className:"text-2xl font-bold text-red-900 mt-1",children:["$",j.highest_cost.toFixed(2)]})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Y,{className:"h-5 w-5 text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-blue-800",children:"Average Cost"})]}),e.jsxs("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:["$",j.average_cost.toFixed(2)]})]}),e.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ue,{className:"h-5 w-5 text-purple-600"}),e.jsx("span",{className:"ml-2 text-sm font-medium text-purple-800",children:"Quote Count"})]}),e.jsx("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:j.quote_count})]})]}),e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Sort by:"}),e.jsxs("select",{value:C,onChange:l=>q(l.target.value),className:"border border-gray-300 rounded-md px-3 py-1 text-sm",children:[e.jsx("option",{value:"cost",children:"Cost"}),e.jsx("option",{value:"response_time",children:"Response Time"}),e.jsx("option",{value:"validity",children:"Validity Period"})]}),e.jsx("button",{onClick:()=>F(S==="asc"?"desc":"asc"),className:"p-1 hover:bg-gray-100 rounded",children:S==="asc"?e.jsx(ue,{className:"h-4 w-4"}):e.jsx(Pe,{className:"h-4 w-4"})})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:I.map(l=>e.jsxs("div",{className:`border rounded-lg p-4 transition-all ${l.cost===(j==null?void 0:j.lowest_cost)?"border-green-300 bg-green-50":l.status==="Accepted"?"border-blue-300 bg-blue-50":"border-gray-200 bg-white"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900 truncate",children:l.supplier.supplier_name}),L(l)]}),e.jsx("p",{className:"text-sm text-gray-600 truncate",children:l.supplier.contact_email})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${H.getStatusColor(l.status)}`,children:l.status})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["$",l.cost.toFixed(2)]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["#",l.cost_rank]})]}),l.cost_percentage_of_lowest>100&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["+",l.cost_percentage_of_lowest-100,"% vs lowest"]})]}),e.jsxs("div",{className:"space-y-2 mb-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:H.formatResponseTime(l.response_time_hours)})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ns,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:H.formatValidityPeriod(l.valid_until)})]})]}),e.jsxs("button",{onClick:()=>T(l.id),className:"w-full flex items-center justify-between text-sm text-blue-600 hover:text-blue-800 mb-3",children:[e.jsx("span",{children:"Details"}),k.has(l.id)?e.jsx(ps,{className:"h-4 w-4"}):e.jsx(ls,{className:"h-4 w-4"})]}),k.has(l.id)&&e.jsxs("div",{className:"border-t pt-3 mb-3",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Cost Breakdown"}),e.jsx("div",{className:"text-sm text-gray-600",children:H.formatCostBreakdown(l.cost_breakdown)})]}),l.notes_capacity&&e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Notes"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-wrap",children:l.notes_capacity})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("h5",{className:"font-medium text-gray-900 mb-2",children:"Services"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[l.supplier.service_categories.slice(0,3).map(m=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:m},m)),l.supplier.service_categories.length>3&&e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:["+",l.supplier.service_categories.length-3," more"]})]})]})]}),l.status==="Submitted"&&e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>P(l.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Accept"})]}),e.jsxs("button",{onClick:()=>A(l.id),className:"flex-1 flex items-center justify-center space-x-1 px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors",children:[e.jsx(cs,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:"Reject"})]})]})]},l.id))})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Y,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Quotes Available"}),e.jsx("p",{className:"text-gray-600",children:"This asset doesn't have any quotes to compare yet."})]})})]})}):null},qs=({onCreateProject:n})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Producer Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage projects and coordinate suppliers"})]}),e.jsxs("button",{onClick:n,className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{children:"New Project"})]})]}),Fs=({projects:n,selectedProject:s,onProjectSelect:t,getStatusColor:a})=>e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Active Projects"}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:n.map(r=>e.jsxs("div",{onClick:()=>t(r),className:`p-4 rounded-lg border cursor-pointer transition-colors ${(s==null?void 0:s.id)===r.id?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:r.project_name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${a(r.project_status)}`,children:r.project_status})]}),e.jsx("p",{className:"text-sm text-gray-600",children:r.client_name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(r.created_at).toLocaleDateString()})]},r.id))})]})}),Is=({project:n,assets:s,onEdit:t,onDelete:a,getStatusColor:r})=>{var c;return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:n.project_name}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r(n.project_status)}`,children:n.project_status})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsxs("button",{onClick:t,className:"flex items-center space-x-1 px-3 py-1 bg-gray-100 text-gray-800 rounded hover:bg-gray-200 text-sm",children:[e.jsx(ys,{className:"h-4 w-4"}),e.jsx("span",{children:"Edit"})]}),e.jsxs("button",{onClick:a,className:"flex items-center space-x-1 px-3 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-sm",children:[e.jsx(vs,{className:"h-4 w-4"}),e.jsx("span",{children:"Delete"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fe,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[s.length," Assets"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Budget: $",((c=n.financial_parameters)==null?void 0:c.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($e,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Due: ",n.timeline_deadline?new Date(n.timeline_deadline).toLocaleDateString():"Not set"]})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Project Brief"}),e.jsx("p",{className:"text-gray-700 text-sm whitespace-pre-wrap",children:n.brief_description})]})]})},Qs=({asset:n,quotes:s,onEdit:t,onDelete:a,onSendToSuppliers:r,onCompareQuotes:c,getStatusColor:i})=>{const u=s.find(p=>p.status==="Accepted"),d=s.length>1;return e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900",children:n.asset_name}),e.jsx("p",{className:"text-sm text-gray-600",children:n.specifications})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i(n.status)}`,children:n.status}),e.jsx("button",{onClick:()=>t(n),className:"px-2 py-1 text-xs rounded bg-gray-100 hover:bg-gray-200",children:"Edit"}),e.jsx("button",{onClick:()=>a(n),className:"px-2 py-1 text-xs rounded bg-red-600 text-white hover:bg-red-700",children:"Delete"}),n.status==="Pending"&&e.jsxs("button",{onClick:()=>r(n),className:"flex items-center space-x-1 px-3 py-1 bg-teal-600 text-white rounded text-sm hover:bg-teal-700",children:[e.jsx(Ie,{className:"h-3 w-3"}),e.jsx("span",{children:"Select Suppliers"})]}),d&&e.jsxs("button",{onClick:()=>c(n.id),className:"flex items-center space-x-1 px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:[e.jsx(ts,{className:"h-3 w-3"}),e.jsx("span",{children:"Compare Quotes"})]})]})]}),s.length>0&&e.jsxs("div",{className:"mt-4 bg-gray-50 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-medium text-gray-900 mb-3",children:["Quotes (",s.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.map(p=>{var w,b;return e.jsx("div",{className:"bg-white rounded p-3 border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:(w=p.supplier)==null?void 0:w.supplier_name}),e.jsx("p",{className:"text-sm text-gray-600",children:(b=p.supplier)==null?void 0:b.contact_email}),e.jsxs("p",{className:"text-lg font-semibold text-green-600 mt-1",children:["$",p.cost.toFixed(2)]}),p.notes_capacity&&e.jsx("p",{className:"text-sm text-gray-700 mt-1 whitespace-pre-wrap",children:p.notes_capacity})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i(p.status)}`,children:p.status}),p.status==="Submitted"&&e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>{},className:"p-1 bg-green-600 text-white rounded hover:bg-green-700",title:"Accept Quote",children:"✓"}),e.jsx("button",{onClick:()=>{},className:"p-1 bg-red-600 text-white rounded hover:bg-red-700",title:"Reject Quote",children:"✗"})]})]})]})},p.id)})})]}),n.assigned_supplier&&u&&e.jsxs("div",{className:"mt-3 p-3 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("p",{className:"text-sm font-medium text-green-800",children:["Assigned to: ",n.assigned_supplier.supplier_name]}),e.jsxs("p",{className:"text-sm text-green-700",children:["Accepted Cost: $",u.cost.toFixed(2)]})]})]})},Ms=({assets:n,quotes:s,aiAllocationCompleted:t,onCreateAsset:a,onEditAsset:r,onDeleteAsset:c,onSendToSuppliers:i,onCompareQuotes:u,onOpenAIAllocation:d,getAssetQuotes:p,hasMultipleQuotes:w,getStatusColor:b})=>e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Asset Management"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{onClick:a,className:"flex items-center space-x-2 px-3 py-1 bg-teal-600 text-white rounded text-sm hover:bg-teal-700",children:[e.jsx(Qe,{className:"h-4 w-4"}),e.jsx("span",{children:"New Asset"})]}),t?e.jsxs("div",{className:"flex items-center space-x-2 px-3 py-1 bg-green-100 text-green-800 rounded text-sm",children:[e.jsx(qe,{className:"h-4 w-4"}),e.jsx("span",{children:"AI Allocation Applied"})]}):e.jsxs("div",{className:"relative group",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-3 py-1 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded text-sm hover:from-purple-700 hover:to-blue-700",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"AI Allocation"}),e.jsx(he,{className:"h-3 w-3"})]}),e.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all duration-200 z-10",children:e.jsx("div",{className:"py-1",children:e.jsxs("button",{onClick:d,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center space-x-2",children:[e.jsx(ws,{className:"h-4 w-4"}),e.jsx("span",{children:"AI Asset Analysis"})]})})})]})]})]}),e.jsx("div",{className:"space-y-6",children:n.map(j=>e.jsx(Qs,{asset:j,quotes:p(j.id),onEdit:r,onDelete:c,onSendToSuppliers:i,onCompareQuotes:u,getStatusColor:b},j.id))})]}),Ts=({isOpen:n,isEditing:s,isSubmitting:t,projectForm:a,allocationMethod:r,onClose:c,onSubmit:i,onFormChange:u,onAllocationMethodChange:d})=>{if(!n)return null;const p=w=>{const{name:b,value:j}=w.target;u(b,b==="financial_parameters"?j===""?void 0:parseFloat(j):j)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s?"Edit Project":"Create New Project"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s?"Update project details and save changes.":"Fill in details to create a new project."})]}),e.jsxs("form",{onSubmit:i,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Project Name *"}),e.jsx("input",{name:"project_name",value:a.project_name,onChange:p,required:!0,type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name *"}),e.jsx("input",{name:"client_name",value:a.client_name,onChange:p,required:!0,type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text.sm font-medium text-gray-700 mb-1",children:"Project Brief *"}),e.jsx("textarea",{name:"brief_description",value:a.brief_description,onChange:p,required:!0,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Physical Parameters"}),e.jsx("input",{name:"physical_parameters",value:a.physical_parameters,onChange:p,type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Budget"}),e.jsx("input",{name:"financial_parameters",value:a.financial_parameters??"",onChange:p,type:"number",min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deadline"}),e.jsx("input",{name:"timeline_deadline",value:a.timeline_deadline,onChange:p,type:"date",className:"w-full px-3 py-2 border border-gray-300 rounded"})]})]}),!s&&e.jsxs("div",{className:"space-y-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Asset Allocation Method:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"allocationMethod",value:"static",checked:r==="static",onChange:()=>d("static"),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 focus:ring-blue-500 focus:ring-2"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Static Allocation"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Rule-based asset identification using keyword matching"})]})]}),e.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer",children:[e.jsx("input",{type:"radio",name:"allocationMethod",value:"ai",checked:r==="ai",onChange:()=>d("ai"),className:"w-4 h-4 text-purple-600 bg-gray-100 border-gray-300 focus:ring-purple-500 focus:ring-2"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"AI-Powered Allocation"}),e.jsx("p",{className:"text-xs text-gray-500",children:"AI analyzes your brief to identify assets with detailed specifications"})]})]})]}),r==="ai"&&e.jsx("div",{className:"mt-3 p-3 bg-purple-100 rounded-lg",children:e.jsx("p",{className:"text-sm text-purple-800",children:"✨ AI will analyze your brief to identify assets, create detailed specifications, and suggest optimal supplier allocations with confidence scores."})})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"px-4 py-2 rounded bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:t?s?"Saving...":"Creating...":s?"Save Changes":"Create Project"})]})]})]})})},Rs=({isOpen:n,isEditing:s,isSubmitting:t,assetForm:a,suppliers:r,onClose:c,onSubmit:i,onFormChange:u})=>{if(!n)return null;const d=p=>{const{name:w,value:b}=p.target;u(w,b)};return e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s?"Edit Asset":"Create New Asset"}),e.jsx("p",{className:"text-gray-600 text-sm",children:s?"Update asset details and save changes.":"Add an asset to this project."})]}),e.jsxs("form",{onSubmit:i,className:"space-y-5",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Asset Name *"}),e.jsx("input",{name:"asset_name",value:a.asset_name,onChange:d,required:!0,type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{name:"status",value:a.status,onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"Pending",children:"Pending"}),e.jsx("option",{value:"Quoting",children:"Quoting"}),e.jsx("option",{value:"Approved",children:"Approved"}),e.jsx("option",{value:"In Production",children:"In Production"}),e.jsx("option",{value:"Delivered",children:"Delivered"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Specifications"}),e.jsx("textarea",{name:"specifications",value:a.specifications,onChange:d,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Timeline"}),e.jsx("input",{name:"timeline",value:a.timeline,onChange:d,type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded",placeholder:"e.g., 2 weeks"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Assigned Supplier"}),e.jsxs("select",{name:"assigned_supplier_id",value:a.assigned_supplier_id||"",onChange:d,className:"w-full px-3 py-2 border border-gray-300 rounded",children:[e.jsx("option",{value:"",children:"Unassigned"}),r.map(p=>e.jsx("option",{value:p.id,children:p.supplier_name},p.id))]})]})]}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:t,className:"px-4 py-2 rounded bg-teal-600 text-white hover:bg-teal-700 disabled:opacity-50",children:t?s?"Saving...":"Creating...":s?"Save Changes":"Create Asset"})]})]})]})})},Ls=({isOpen:n,availableTags:s,selectedTags:t,onClose:a,onTagToggle:r,onConfirm:c})=>n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-xl p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Filter Suppliers by Tags"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Select tags to filter suppliers who will receive this request."})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.length===0&&e.jsx("span",{className:"text-sm text-gray-500",children:"No tags available. All relevant suppliers will be selected."}),s.map(i=>{const u=t.includes(i);return e.jsx("button",{type:"button",onClick:()=>r(i),className:`px-3 py-1 rounded-full text-sm border ${u?"bg-teal-600 text-white border-teal-600":"bg-white text-gray-800 border-gray-300"}`,children:i},i)})]})}),e.jsxs("div",{className:"flex justify-end space-x-2 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded bg-teal-600 text-white hover:bg-teal-700",children:"Send Requests"})]})]})}):null,Ds=({isOpen:n,asset:s,suggestedSuppliers:t,selectedSupplierIds:a,loading:r,onClose:c,onSupplierToggle:i,onConfirm:u})=>n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-2xl p-6 max-h-[80vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Select Suppliers for Quote Requests"}),e.jsxs("p",{className:"text-gray-600 text-sm",children:['Choose which suppliers should receive quote requests for "',s==null?void 0:s.asset_name,'".']})]}),r?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading suppliers..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"mb-4",children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:t.length===0?e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Fe,{className:"h-12 w-12 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"No relevant suppliers found for this asset."}),e.jsx("p",{className:"text-sm",children:"Try adding more suppliers or check the asset specifications."})]}):t.map(d=>{const p=a.includes(d.id),w=d.already_contacted;return e.jsx("div",{className:`border rounded-lg p-4 transition-colors ${p?"border-teal-500 bg-teal-50":"border-gray-200 hover:border-gray-300"} ${w?"opacity-75":""}`,children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("input",{type:"checkbox",id:`supplier-${d.id}`,checked:p,onChange:()=>i(d.id),disabled:w,className:"h-4 w-4 text-teal-600 focus:ring-teal-500 border-gray-300 rounded"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("label",{htmlFor:`supplier-${d.id}`,className:"font-medium text-gray-900 cursor-pointer",children:d.supplier_name}),w&&e.jsx("span",{className:"px-2 py-1 text-xs bg-yellow-100 text-yellow-800 rounded-full",children:"Already Contacted"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:d.contact_email}),d.service_categories&&d.service_categories.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-2",children:d.service_categories.map((b,j)=>e.jsx("span",{className:"px-2 py-1 text-xs bg-gray-100 text-gray-700 rounded",children:b},j))})]})]})},d.id)})})}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[e.jsx("div",{className:"text-sm text-gray-600",children:a.length>0&&e.jsxs("span",{children:[a.length," supplier",a.length!==1?"s":""," selected"]})}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"button",onClick:c,className:"px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:u,disabled:a.length===0,className:`px-4 py-2 rounded text-white ${a.length===0?"bg-gray-400 cursor-not-allowed":"bg-teal-600 hover:bg-teal-700"}`,children:["Send Quote Requests",a.length>0?` (${a.length})`:""]})]})]})]})]})}):null,zs=({isOpen:n,aiSuggestions:s,loading:t,onClose:a,onAnalyze:r,onApply:c})=>n?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-40",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-full max-w-4xl p-6 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx(se,{className:"h-6 w-6 text-purple-600"}),e.jsx("h3",{className:"text-xl font-semibold",children:"AI Asset Analysis"}),e.jsx(he,{className:"h-5 w-5 text-purple-500"})]}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Analyze the project brief to identify and suggest optimal assets with detailed specifications."})]}),s?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-blue-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"AI Analysis Complete"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Confidence: ",Math.round(s.confidence*100),"%"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm text-green-700 font-medium",children:"Ready"})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"AI Reasoning"}),e.jsx("p",{className:"text-sm text-gray-700",children:s.reasoning})]}),s.assets.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-3",children:["Suggested Assets (",s.assets.length,")"]}),e.jsx("div",{className:"space-y-3",children:s.assets.map((i,u)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:i.asset_name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.priority==="high"?"bg-red-100 text-red-800":i.priority==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[i.priority," priority"]}),e.jsxs("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${i.estimated_cost_range==="high"?"bg-red-100 text-red-800":i.estimated_cost_range==="medium"?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[i.estimated_cost_range," cost"]})]})]}),e.jsx("p",{className:"text-sm text-gray-600",children:i.specifications})]},u))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:a,className:"px-4 py-2 rounded border border-gray-300 text-gray-700 hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:c,className:"flex items-center space-x-2 px-6 py-2 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700",children:[e.jsx(se,{className:"h-4 w-4"}),e.jsx("span",{children:"Apply AI Suggestions"})]})]})]}):e.jsx("div",{className:"text-center py-8",children:t?e.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600"}),e.jsx("p",{className:"text-gray-600",children:"AI is analyzing your project..."}),e.jsx("p",{className:"text-sm text-gray-500",children:"This may take a few moments"})]}):e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border border-purple-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Ready to analyze"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Click the button below to start AI analysis of your project."}),e.jsxs("button",{onClick:r,className:"flex items-center space-x-2 px-6 py-3 bg-gradient-to-r from-purple-600 to-blue-600 text-white rounded-lg hover:from-purple-700 hover:to-blue-700 mx-auto",children:[e.jsx(se,{className:"h-5 w-5"}),e.jsx("span",{children:"Start AI Analysis"}),e.jsx(he,{className:"h-4 w-4"})]})]})})})]})}):null,Xs=()=>{const{showSuccess:n,showError:s,showWarning:t}=G(),{projects:a,currentProject:r,isLoading:c,showProjectModal:i,isEditingProject:u,isSubmittingProject:d,projectForm:p,allocationMethod:w,selectProject:b,openCreateProject:j,openEditProject:E,closeProjectModal:k,updateProjectForm:$,setAllocationMethod:C,submitProjectForm:q,deleteProject:S}=Ps(),{assets:F,quotes:N,suppliers:P,showAssetModal:A,isEditingAsset:T,isSubmittingAsset:I,assetForm:L,loadProjectDetails:l,openCreateAsset:m,openEditAsset:_,closeAssetModal:g,updateAssetForm:x,submitAssetForm:v,deleteAsset:z}=ks(r),[W,U]=o.useState(!1),[R,B]=o.useState(null),[Q,V]=o.useState([]),[Me,te]=o.useState(!1),[ae,re]=o.useState(null),[Te,le]=o.useState([]),[ie,X]=o.useState([]),[Re,ge]=o.useState(!1),[Le,fe]=o.useState(!1),[J,ne]=o.useState(null),[ce,oe]=o.useState([]),[De,de]=o.useState(!1),[K,Z]=o.useState(null),[ze,je]=o.useState(!1),[me,ye]=o.useState(!1),[be,we]=o.useState(!1),[Ne,ve]=o.useState(null);o.useEffect(()=>{r&&ye(!!r.ai_allocation_completed_at)},[r]);const Be=async f=>{re(f),X([]),te(!0),await Ue(f.id)},Ue=async f=>{ge(!0);try{const h=await Ss.getSuggestedSuppliers(f);le(h.suggestedSuppliers)}catch(h){console.error("Failed to load suggested suppliers:",h),s("Failed to load supplier suggestions")}finally{ge(!1)}},Ve=f=>{X(h=>h.includes(f)?h.filter(O=>O!==f):[...h,f])},Oe=async()=>{!ae||ie.length===0||(ne(ae),oe(ie),fe(!0),te(!1),re(null),X([]),le([]))},We=async f=>{if(!(!J||ce.length===0))try{const h=await M.loadProducerSettings(),O=h?{name:h.from_name,email:h.from_email}:void 0,ee=await Cs.sendQuoteRequests(J.id,ce,f,O?{name:String(O.name),email:String(O.email)}:void 0);await l(r.id),ee.data.successful_requests>0&&n(`Quote requests sent to ${ee.data.successful_requests} supplier(s) for ${J.asset_name}`),ee.data.failed_requests>0&&t(`Warning: ${ee.data.failed_requests} request(s) failed to send`)}catch(h){throw console.error("Error sending quote requests:",h),s("Failed to send quote requests"),h}finally{ne(null),oe([])}},xe=f=>{switch(f){case"Completed":case"Delivered":case"Approved":case"Accepted":return"bg-green-100 text-green-800";case"In Progress":case"In Production":case"Quoting":case"Submitted":return"bg-yellow-100 text-yellow-800";case"Cancelled":case"Rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},_e=f=>N.filter(h=>h.asset_id===f),He=M.getAvailableTags(P),Ye=async()=>{if(!(!R||!r))try{await As.sendQuoteRequestsForAsset(R,Q),await l(r.id),n(`Quote requests sent for ${R.asset_name}`)}catch(f){console.error("Error sending to suppliers:",f),s("Failed to send quote requests")}finally{U(!1),B(null),V([])}},Ge=f=>_e(f).length>1,Xe=f=>{ve(f),we(!0)},Je=()=>{we(!1),ve(null)},Ke=()=>{r&&l(r.id)},Ze=()=>{!r||me||(de(!0),Z(null))},es=async()=>{var f;if(r){je(!0);try{let h;h=await ke.analyzeBriefForAssets(r.brief_description,{financial_parameters:r.financial_parameters,timeline_deadline:r.timeline_deadline,physical_parameters:r.physical_parameters}),h.success&&h.data?Z({assets:h.data.assets||[],reasoning:h.data.reasoning||"",confidence:h.data.confidence||0}):s(`AI analysis failed: ${((f=h.error)==null?void 0:f.message)||"Unknown error"}`)}catch(h){console.error("AI analysis error:",h),s("AI analysis failed. Please try again.")}finally{je(!1)}}},ss=async()=>{var f;if(!(!K||!r))try{if(K.assets.length>0){const h=await ke.createAssetsFromAI(r.id,K.assets);if(!h.success)throw new Error(((f=h.error)==null?void 0:f.message)||"Failed to create assets")}await l(r.id),de(!1),Z(null),ye(!0),n("AI suggestions applied successfully! AI allocation is now complete.",{duration:6e3})}catch(h){console.error("Error applying AI suggestions:",h),s("Failed to apply AI suggestions. Please try again.")}};return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(qs,{onCreateProject:j}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx(Fs,{projects:a,selectedProject:r,onProjectSelect:b,getStatusColor:xe}),e.jsx("div",{className:"lg:col-span-2",children:r?e.jsxs("div",{className:"space-y-6",children:[e.jsx(Is,{project:r,assets:F,onEdit:E,onDelete:S,getStatusColor:xe}),e.jsx(Ms,{assets:F,quotes:N,aiAllocationCompleted:me,onCreateAsset:m,onEditAsset:_,onDeleteAsset:z,onSendToSuppliers:Be,onCompareQuotes:Xe,onOpenAIAllocation:Ze,getAssetQuotes:_e,hasMultipleQuotes:Ge,getStatusColor:xe})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 text-center",children:[e.jsx(as,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Select a Project"}),e.jsx("p",{className:"text-gray-600",children:"Choose a project from the list to view details and manage assets"})]})})]}),e.jsx(Ts,{isOpen:i,isEditing:u,isSubmitting:d,projectForm:p,allocationMethod:w,onClose:k,onSubmit:q,onFormChange:$,onAllocationMethodChange:C}),e.jsx(Rs,{isOpen:A,isEditing:T,isSubmitting:I,assetForm:L,suppliers:P,onClose:g,onSubmit:v,onFormChange:(f,h)=>x(f,h)}),e.jsx(Ls,{isOpen:W,availableTags:He,selectedTags:Q,onClose:()=>{U(!1),V([]),B(null)},onTagToggle:f=>V(h=>h.includes(f)?h.filter(O=>O!==f):[...h,f]),onConfirm:Ye}),e.jsx(Ds,{isOpen:Me,asset:ae,suggestedSuppliers:Te,selectedSupplierIds:ie,loading:Re,onClose:()=>{te(!1),re(null),X([]),le([])},onSupplierToggle:Ve,onConfirm:Oe}),e.jsx(Es,{isOpen:Le,onClose:()=>{fe(!1),ne(null),oe([])},asset:J,supplierIds:ce,onSend:We}),e.jsx(zs,{isOpen:De&&!me,aiSuggestions:K,loading:ze,onClose:()=>{de(!1),Z(null)},onAnalyze:es,onApply:ss}),be&&Ne&&e.jsx($s,{isOpen:be,onClose:Je,assetId:Ne,onQuoteUpdate:Ke})]})};export{Xs as default};
