import{d as C,j as e,X as N,r as y,R as H,U as D,f as Q}from"./index-Bj-tmwIw.js";import{s as _}from"./supabase-D_wOUl-A.js";import{C as P,U as F,a as T,S as E,M as X,P as Y}from"./user-GNX0SQJ0.js";import{C as J}from"./calendar-BVjs4xWM.js";/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],O=C("check",K);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],ee=C("search",Z);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],te=C("square-pen",se);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],R=C("tag",ae);/**
 * @license lucide-react v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],$=C("trash-2",re),le=({searchTerm:s,onSearchChange:l,placeholder:a="Search suppliers by name..."})=>e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(ee,{className:"h-4 w-4 text-gray-400"})}),e.jsx("input",{type:"text",value:s,onChange:i=>l(i.target.value),placeholder:a,className:"block w-full pl-10 pr-10 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm"}),s&&e.jsx("button",{onClick:()=>l(""),className:"absolute inset-y-0 right-0 pr-3 flex items-center text-gray-400 hover:text-gray-600",children:e.jsx(N,{className:"h-4 w-4"})})]}),ne=({selectedCategories:s,onCategoriesChange:l,availableCategories:a})=>{const[i,c]=y.useState(!1),p=y.useRef(null),h=Object.entries({Production:["Printing","Graphics","Banners","Staging","Audio","Lighting"],Catering:["Catering","Food","Beverages"],Creative:["Design","Branding","Marketing"],Media:["Photography","Video"],Logistics:["Transport","Logistics","Delivery"],Security:["Security"]}).map(([n,m])=>[n,m.filter(d=>a.includes(d))]).filter(([,n])=>n.length>0),j=n=>{s.includes(n)?l(s.filter(m=>m!==n)):l([...s,n])},o=n=>{if(n.every(d=>s.includes(d)))l(s.filter(d=>!n.includes(d)));else{const d=[...s];n.forEach(u=>{d.includes(u)||d.push(u)}),l(d)}};return y.useEffect(()=>{const n=m=>{p.current&&!p.current.contains(m.target)&&c(!1)};return document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n)},[]),e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("button",{onClick:()=>c(!i),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx(R,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:["Categories",s.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-teal-100 text-teal-700 rounded-full text-xs",children:s.length})]}),e.jsx(P,{className:`h-4 w-4 text-gray-400 transition-transform ${i?"rotate-180":""}`})]}),i&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-96 overflow-y-auto",children:e.jsx("div",{className:"p-4 space-y-4",children:h.map(([n,m])=>{const d=m.every(u=>s.includes(u));return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:n}),e.jsx("button",{onClick:()=>o(m),className:"text-xs text-teal-600 hover:text-teal-800",children:d?"Deselect All":"Select All"})]}),e.jsx("div",{className:"grid grid-cols-1 gap-1",children:m.map(u=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:s.includes(u),onChange:()=>j(u),className:"sr-only"}),e.jsx("div",{className:`w-4 h-4 border-2 rounded flex items-center justify-center ${s.includes(u)?"bg-teal-600 border-teal-600":"border-gray-300"}`,children:s.includes(u)&&e.jsx(O,{className:"h-3 w-3 text-white"})})]}),e.jsx("span",{className:"text-sm text-gray-700",children:u})]},u))})]},n)})})})]})},ce=({selectedRoles:s,onRolesChange:l,suppliers:a})=>{const[i,c]=y.useState(!1),p=y.useRef(null),x=H.useMemo(()=>{const o=new Set;return a.forEach(n=>{var m;(m=n.contact_persons)==null||m.forEach(d=>{d.role&&d.role.trim()&&o.add(d.role.trim())})}),Array.from(o).sort()},[a]),h=o=>{s.includes(o)?l(s.filter(n=>n!==o)):l([...s,o])},j=()=>{s.length===x.length?l([]):l([...x])};return y.useEffect(()=>{const o=n=>{p.current&&!p.current.contains(n.target)&&c(!1)};return document.addEventListener("mousedown",o),()=>document.removeEventListener("mousedown",o)},[]),x.length===0?null:e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("button",{onClick:()=>c(!i),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsx(F,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-gray-700",children:["Contact Roles",s.length>0&&e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-teal-100 text-teal-700 rounded-full text-xs",children:s.length})]}),e.jsx(P,{className:`h-4 w-4 text-gray-400 transition-transform ${i?"rotate-180":""}`})]}),i&&e.jsx("div",{className:"absolute top-full left-0 mt-1 w-64 bg-white border border-gray-200 rounded-lg shadow-lg z-50 max-h-80 overflow-y-auto",children:e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900",children:"Contact Roles"}),e.jsx("button",{onClick:j,className:"text-xs text-teal-600 hover:text-teal-800",children:s.length===x.length?"Deselect All":"Select All"})]}),e.jsx("div",{className:"space-y-1",children:x.map(o=>e.jsxs("label",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 rounded cursor-pointer",children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"checkbox",checked:s.includes(o),onChange:()=>h(o),className:"sr-only"}),e.jsx("div",{className:`w-4 h-4 border-2 rounded flex items-center justify-center ${s.includes(o)?"bg-teal-600 border-teal-600":"border-gray-300"}`,children:s.includes(o)&&e.jsx(O,{className:"h-3 w-3 text-white"})})]}),e.jsx("span",{className:"text-sm text-gray-700",children:o})]},o))})]})})]})},oe=({hasContactPersons:s,onHasContactPersonsChange:l,dateRange:a,onDateRangeChange:i,onClearAll:c,hasActiveFilters:p})=>{const[x,h]=y.useState(!1),j=y.useRef(null),o=d=>{const u=new Date;let f=null,b=null;switch(d){case"last30days":f=new Date(u.getTime()-30*24*60*60*1e3),b=u;break;case"last3months":f=new Date(u.getTime()-90*24*60*60*1e3),b=u;break;case"last6months":f=new Date(u.getTime()-180*24*60*60*1e3),b=u;break;case"thisyear":f=new Date(u.getFullYear(),0,1),b=u;break;case"clear":f=null,b=null;break}i({start:f,end:b})},n=()=>!a.start&&!a.end?"":a.start&&a.end?`${a.start.toLocaleDateString()} - ${a.end.toLocaleDateString()}`:a.start?`From ${a.start.toLocaleDateString()}`:a.end?`Until ${a.end.toLocaleDateString()}`:"";y.useEffect(()=>{const d=u=>{j.current&&!j.current.contains(u.target)&&h(!1)};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[]);const m=s!==null||a.start||a.end;return e.jsxs("div",{className:"relative",ref:j,children:[e.jsxs("button",{onClick:()=>h(!x),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 focus:ring-2 focus:ring-teal-500 focus:border-transparent text-sm",children:[e.jsxs("span",{className:"text-gray-700",children:["More",m&&e.jsx("span",{className:"ml-1 px-2 py-0.5 bg-teal-100 text-teal-700 rounded-full text-xs",children:[s!==null,a.start,a.end].filter(Boolean).length})]}),e.jsx(P,{className:`h-4 w-4 text-gray-400 transition-transform ${x?"rotate-180":""}`})]}),x&&e.jsx("div",{className:"absolute top-full right-0 mt-1 w-80 bg-white border border-gray-200 rounded-lg shadow-lg z-50",children:e.jsxs("div",{className:"p-4 space-y-4",children:[p&&e.jsx("div",{className:"pb-3 border-b border-gray-200",children:e.jsxs("button",{onClick:()=>{c(),h(!1)},className:"flex items-center space-x-2 text-sm text-red-600 hover:text-red-800",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:"Clear All Filters"})]})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[e.jsx(D,{className:"h-4 w-4"}),e.jsx("span",{children:"Contact Information"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"hasContactPersons",checked:s===null,onChange:()=>l(null),className:"text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"All suppliers"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"hasContactPersons",checked:s===!0,onChange:()=>l(!0),className:"text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"With contact persons"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",name:"hasContactPersons",checked:s===!1,onChange:()=>l(!1),className:"text-teal-600 focus:ring-teal-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Without contact persons"})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900 mb-2 flex items-center space-x-2",children:[e.jsx(J,{className:"h-4 w-4"}),e.jsx("span",{children:"Added Date"})]}),e.jsxs("div",{className:"space-y-2 mb-3",children:[e.jsx("div",{className:"text-xs text-gray-600 mb-2",children:"Quick select:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsx("button",{onClick:()=>o("last30days"),className:"text-xs px-2 py-1 border border-gray-200 rounded hover:bg-gray-50",children:"Last 30 days"}),e.jsx("button",{onClick:()=>o("last3months"),className:"text-xs px-2 py-1 border border-gray-200 rounded hover:bg-gray-50",children:"Last 3 months"}),e.jsx("button",{onClick:()=>o("last6months"),className:"text-xs px-2 py-1 border border-gray-200 rounded hover:bg-gray-50",children:"Last 6 months"}),e.jsx("button",{onClick:()=>o("thisyear"),className:"text-xs px-2 py-1 border border-gray-200 rounded hover:bg-gray-50",children:"This year"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs text-gray-600",children:"Custom range:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"From"}),e.jsx("input",{type:"date",value:a.start?a.start.toISOString().split("T")[0]:"",onChange:d=>i({...a,start:d.target.value?new Date(d.target.value):null}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"To"}),e.jsx("input",{type:"date",value:a.end?a.end.toISOString().split("T")[0]:"",onChange:d=>i({...a,end:d.target.value?new Date(d.target.value):null}),className:"w-full px-2 py-1 text-xs border border-gray-300 rounded focus:ring-1 focus:ring-teal-500 focus:border-transparent"})]})]}),n()&&e.jsxs("div",{className:"text-xs text-gray-600",children:["Selected: ",n()]}),e.jsx("button",{onClick:()=>o("clear"),className:"text-xs text-gray-500 hover:text-gray-700",children:"Clear date range"})]})]})]})})]})},ie=({searchTerm:s,selectedCategories:l,selectedRoles:a,hasContactPersons:i,dateRange:c,onClearSearch:p,onClearCategories:x,onClearRoles:h,onClearContactPersons:j,onClearDateRange:o,onClearAll:n})=>{if(!(s||l.length>0||a.length>0||i!==null||c.start||c.end))return null;const d=()=>!c.start&&!c.end?"":c.start&&c.end?`${c.start.toLocaleDateString()} - ${c.end.toLocaleDateString()}`:c.start?`From ${c.start.toLocaleDateString()}`:c.end?`Until ${c.end.toLocaleDateString()}`:"";return e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Active filters:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-teal-100 text-teal-800 text-xs rounded-full",children:['Name: "',s,'"',e.jsx("button",{onClick:p,className:"ml-1 text-teal-600 hover:text-teal-800",children:e.jsx(N,{className:"h-3 w-3"})})]}),l.length>0&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:["Categories: ",l.length,e.jsx("button",{onClick:x,className:"ml-1 text-blue-600 hover:text-blue-800",children:e.jsx(N,{className:"h-3 w-3"})})]}),a.length>0&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded-full",children:["Roles: ",a.length,e.jsx("button",{onClick:h,className:"ml-1 text-purple-600 hover:text-purple-800",children:e.jsx(N,{className:"h-3 w-3"})})]}),i!==null&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full",children:[i?"With contacts":"Without contacts",e.jsx("button",{onClick:j,className:"ml-1 text-green-600 hover:text-green-800",children:e.jsx(N,{className:"h-3 w-3"})})]}),d()&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-orange-100 text-orange-800 text-xs rounded-full",children:[d(),e.jsx("button",{onClick:o,className:"ml-1 text-orange-600 hover:text-orange-800",children:e.jsx(N,{className:"h-3 w-3"})})]})]})]}),e.jsxs("button",{onClick:n,className:"text-sm text-gray-500 hover:text-gray-700 flex items-center space-x-1",children:[e.jsx(N,{className:"h-4 w-4"}),e.jsx("span",{children:"Clear all"})]})]})})},de=({filters:s,onFiltersChange:l,suppliers:a,availableCategories:i})=>{const c=(m,d)=>{l({...s,[m]:d})},p=()=>{l({searchTerm:"",selectedCategories:[],selectedRoles:[],hasContactPersons:null,dateRange:{start:null,end:null}})},x=()=>c("searchTerm",""),h=()=>c("selectedCategories",[]),j=()=>c("selectedRoles",[]),o=()=>c("hasContactPersons",null),n=()=>c("dateRange",{start:null,end:null});return e.jsxs("div",{className:"space-y-0",children:[e.jsx("div",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(le,{searchTerm:s.searchTerm,onSearchChange:m=>c("searchTerm",m)}),e.jsx(ne,{selectedCategories:s.selectedCategories,onCategoriesChange:m=>c("selectedCategories",m),availableCategories:i}),e.jsx(ce,{selectedRoles:s.selectedRoles,onRolesChange:m=>c("selectedRoles",m),suppliers:a}),e.jsx(oe,{hasContactPersons:s.hasContactPersons,onHasContactPersonsChange:m=>c("hasContactPersons",m),dateRange:s.dateRange,onDateRangeChange:m=>c("dateRange",m),onClearAll:p,hasActiveFilters:s.searchTerm!==""||s.selectedCategories.length>0||s.selectedRoles.length>0||s.hasContactPersons!==null||s.dateRange.start!==null||s.dateRange.end!==null})]})}),e.jsx(ie,{searchTerm:s.searchTerm,selectedCategories:s.selectedCategories,selectedRoles:s.selectedRoles,hasContactPersons:s.hasContactPersons,dateRange:s.dateRange,onClearSearch:x,onClearCategories:h,onClearRoles:j,onClearContactPersons:o,onClearDateRange:n,onClearAll:p})]})},xe=(s,l)=>s.filter(a=>{var i,c,p;if(l.searchTerm){const x=l.searchTerm.toLowerCase(),h=a.supplier_name.toLowerCase().includes(x),j=a.contact_email.toLowerCase().includes(x),o=((i=a.contact_persons)==null?void 0:i.some(n=>n.name.toLowerCase().includes(x)))||!1;if(!h&&!j&&!o)return!1}if(l.selectedCategories.length>0&&!l.selectedCategories.some(h=>a.service_categories.includes(h))||l.selectedRoles.length>0&&!(((c=a.contact_persons)==null?void 0:c.some(h=>l.selectedRoles.includes(h.role)))||!1))return!1;if(l.hasContactPersons!==null){const x=(((p=a.contact_persons)==null?void 0:p.length)||0)>0;if(l.hasContactPersons!==x)return!1}if(l.dateRange.start||l.dateRange.end){const x=new Date(a.created_at);if(l.dateRange.start&&x<l.dateRange.start)return!1;if(l.dateRange.end){const h=new Date(l.dateRange.end);if(h.setHours(23,59,59,999),x>h)return!1}}return!0}),me=(s,l,a)=>{const i=s.length,c=l.length,p=a.searchTerm!==""||a.selectedCategories.length>0||a.selectedRoles.length>0||a.hasContactPersons!==null||a.dateRange.start!==null||a.dateRange.end!==null;return{totalSuppliers:i,filteredCount:c,hasActiveFilters:p,isFiltered:p&&c!==i}},ue=(s,l)=>{let a;return(...i)=>{clearTimeout(a),a=setTimeout(()=>s(...i),l)}},je=()=>{const{showSuccess:s,showError:l,showConfirm:a}=Q(),[i,c]=y.useState([]),[p,x]=y.useState(!1),[h,j]=y.useState(null),[o,n]=y.useState({supplier_name:"",contact_email:"",service_categories:[],contact_persons:[]}),[m,d]=y.useState(!0),[u,f]=y.useState({searchTerm:"",selectedCategories:[],selectedRoles:[],hasContactPersons:null,dateRange:{start:null,end:null}}),b=["Printing","Graphics","Banners","Staging","Audio","Lighting","Catering","Food","Beverages","Design","Branding","Marketing","Transport","Logistics","Delivery","Photography","Video","Security"];y.useEffect(()=>{A()},[]);const S=y.useMemo(()=>xe(i,u),[i,u]),v=y.useMemo(()=>me(i,S,u),[i,S,u]);y.useMemo(()=>ue(t=>f(t),300),[]);const A=async()=>{try{const{data:t,error:r}=await _.from("suppliers").select("*").order("supplier_name");if(r)throw r;c(t||[])}catch(t){console.error("Error loading suppliers:",t)}finally{d(!1)}},B=async t=>{t.preventDefault();try{if(h){const{error:r}=await _.from("suppliers").update(o).eq("id",h.id);if(r)throw r;j(null)}else{const{error:r}=await _.from("suppliers").insert(o);if(r)throw r;x(!1)}n({supplier_name:"",contact_email:"",service_categories:[],contact_persons:[]}),await A(),s(h?"Supplier updated successfully":"Supplier added successfully")}catch(r){console.error("Error saving supplier:",r),l("Failed to save supplier")}},q=t=>{n({supplier_name:t.supplier_name,contact_email:t.contact_email,service_categories:t.service_categories,contact_persons:t.contact_persons||[]}),j(t),x(!0)},I=async t=>{if(await a({title:"Delete Supplier",message:"Are you sure you want to delete this supplier?",variant:"danger",confirmText:"Delete",cancelText:"Cancel"}))try{const{error:g}=await _.from("suppliers").delete().eq("id",t);if(g)throw g;await A(),s("Supplier deleted successfully")}catch(g){console.error("Error deleting supplier:",g),l("Failed to delete supplier")}},U=t=>{n(r=>({...r,service_categories:r.service_categories.includes(t)?r.service_categories.filter(g=>g!==t):[...r.service_categories,t]}))},z=()=>{n(t=>({...t,contact_persons:[...t.contact_persons,{name:"",email:"",role:"",phone:"",is_primary:t.contact_persons.length===0}]}))},G=t=>{n(r=>({...r,contact_persons:r.contact_persons.filter((g,w)=>w!==t)}))},k=(t,r,g)=>{n(w=>({...w,contact_persons:w.contact_persons.map((L,W)=>W===t?{...L,[r]:g}:L)}))},V=t=>{n(r=>({...r,contact_persons:r.contact_persons.map((g,w)=>({...g,is_primary:w===t}))}))},M=()=>{x(!1),j(null),n({supplier_name:"",contact_email:"",service_categories:[],contact_persons:[]})};return m?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-teal-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Supplier Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your supplier network and categories"})]}),e.jsxs("button",{onClick:()=>x(!0),className:"flex items-center space-x-2 px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Supplier"})]})]}),p&&e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:h?"Edit Supplier":"Add New Supplier"}),e.jsx("button",{onClick:M,className:"text-gray-500 hover:text-gray-700",children:"×"})]}),e.jsxs("form",{onSubmit:B,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"supplier_name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),e.jsx("input",{type:"text",id:"supplier_name",value:o.supplier_name,onChange:t=>n(r=>({...r,supplier_name:t.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"contact_email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Email *"}),e.jsx("input",{type:"email",id:"contact_email",value:o.contact_email,onChange:t=>n(r=>({...r,contact_email:t.target.value})),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Service Categories"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2",children:b.map(t=>e.jsx("button",{type:"button",onClick:()=>U(t),className:`px-3 py-2 text-sm rounded-lg border transition-colors ${o.service_categories.includes(t)?"bg-teal-100 border-teal-300 text-teal-700":"bg-gray-50 border-gray-200 text-gray-700 hover:bg-gray-100"}`,children:t},t))})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Contact Person(s)"}),e.jsxs("button",{type:"button",onClick:z,className:"flex items-center space-x-1 px-3 py-1 text-sm bg-teal-100 text-teal-700 rounded-lg hover:bg-teal-200 transition-colors",children:[e.jsx(T,{className:"h-4 w-4"}),e.jsx("span",{children:"Add Contact"})]})]}),o.contact_persons.length===0?e.jsx("div",{className:"text-center py-4 text-gray-500 text-sm",children:'No contact persons added yet. Click "Add Contact" to add one.'}):e.jsx("div",{className:"space-y-3",children:o.contact_persons.map((t,r)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(F,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Contact Person ",r+1]}),t.is_primary&&e.jsxs("div",{className:"flex items-center space-x-1 px-2 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs",children:[e.jsx(E,{className:"h-3 w-3"}),e.jsx("span",{children:"Primary"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[!t.is_primary&&e.jsx("button",{type:"button",onClick:()=>V(r),className:"text-xs text-blue-600 hover:text-blue-800",children:"Set Primary"}),e.jsx("button",{type:"button",onClick:()=>G(r),className:"text-red-500 hover:text-red-700",children:e.jsx($,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Name *"}),e.jsx("input",{type:"text",value:t.name,onChange:g=>k(r,"name",g.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"Contact person name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:t.email,onChange:g=>k(r,"email",g.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"contact@supplier.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Role"}),e.jsx("input",{type:"text",value:t.role,onChange:g=>k(r,"role",g.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"e.g., Sales Manager, Project Coordinator"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Phone"}),e.jsx("input",{type:"tel",value:t.phone||"",onChange:g=>k(r,"phone",g.target.value),className:"w-full px-3 py-2 text-sm border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500 focus:border-transparent",placeholder:"+1-555-0123"})]})]})]},r))})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:M,className:"px-4 py-2 text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700",children:h?"Update Supplier":"Add Supplier"})]})]})]}),e.jsx(de,{filters:u,onFiltersChange:f,suppliers:i,availableCategories:b}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(D,{className:"h-6 w-6 text-teal-600"}),e.jsxs("h2",{className:"text-xl font-semibold",children:["Active Suppliers",v.isFiltered?e.jsxs("span",{className:"text-gray-600 font-normal",children:[" ","(",v.filteredCount," of ",v.totalSuppliers,")"]}):e.jsxs("span",{className:"text-gray-600 font-normal",children:[" ","(",v.totalSuppliers,")"]})]})]}),v.isFiltered&&e.jsx("div",{className:"text-sm text-gray-500",children:v.filteredCount===0?"No suppliers match your filters":"Filtered results"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:S.map(t=>e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:t.supplier_name}),e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[e.jsx(X,{className:"h-4 w-4"}),e.jsx("span",{className:"text-sm",children:t.contact_email})]})]}),t.contact_persons&&t.contact_persons.length>0&&e.jsxs("div",{className:"mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(D,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Contact Persons:"})]}),e.jsx("div",{className:"space-y-1",children:t.contact_persons.map((r,g)=>e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(F,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:r.name}),r.role&&e.jsxs("span",{className:"text-gray-500",children:["(",r.role,")"]}),r.is_primary&&e.jsxs("div",{className:"flex items-center space-x-1 px-1 py-0.5 bg-yellow-100 text-yellow-700 rounded text-xs",children:[e.jsx(E,{className:"h-2 w-2"}),e.jsx("span",{children:"Primary"})]})]}),r.phone&&e.jsxs("div",{className:"flex items-center space-x-1 text-gray-500",children:[e.jsx(Y,{className:"h-3 w-3"}),e.jsx("span",{children:r.phone})]})]},g))})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"h-4 w-4 text-gray-400"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:t.service_categories.map(r=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded-full",children:r},r))})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>q(t),className:"p-2 text-gray-500 hover:text-teal-600 hover:bg-teal-50 rounded",title:"Edit Supplier",children:e.jsx(te,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>I(t.id),className:"p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded",title:"Delete Supplier",children:e.jsx($,{className:"h-4 w-4"})})]})]})},t.id))}),S.length===0&&e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(D,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),i.length===0?e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No suppliers yet"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Add your first supplier to start managing your network"}),e.jsx("button",{onClick:()=>x(!0),className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700",children:"Add First Supplier"})]}):e.jsxs(e.Fragment,{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No suppliers match your filters"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search criteria or clearing some filters"}),e.jsx("button",{onClick:()=>f({searchTerm:"",selectedCategories:[],selectedRoles:[],hasContactPersons:null,dateRange:{start:null,end:null}}),className:"px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700",children:"Clear All Filters"})]})]})]})]})};export{je as default};
